{
    "collab_server" : "",
    "contents" : "feedbackgroup <-\nfunction(fit, quantiles =  NA, values = NA, dist = \"best\", sfg = 3){\n\t\n\t\n\tn.experts <- nrow(fit$limits)\n\texpertnames <- paste(\"expert.\", LETTERS[1:n.experts], sep=\"\")\n\t\n\tdistributions <- data.frame(matrix(0, nrow = 1, ncol = n.experts))\n\tnames(distributions) <- expertnames\n\tdistribution.names <- c(\"Normal\", \"Student-t\", \"Gamma\", \"Log normal\", \"Log Student-t\", \"Beta\")\n\t\n\n\t\n\tif(is.na(quantiles[1]) == T ){\n\t\tquantiles <- fit$probs[1,]\t\t\n\t}\n\texpert.quantiles <- data.frame(matrix(0, nrow = length(quantiles), ncol = n.experts), row.names = quantiles)\n\tnames(expert.quantiles) <- expertnames\n\t\n\tif(is.na(values[1]) == T ){\n\t\tvalues <- fit$vals[1,]\n\t}\n\texpert.probs <- data.frame(matrix(0, nrow = length(values), ncol = n.experts), row.names = values)\n\tnames(expert.probs) <- expertnames\n\t\n\tfor(i in 1:n.experts){\n\t\td.index<- c(1:2)\n\t\tif(fit$limits[i,1]>-Inf){\n\t\t\td.index <- c(1:5)\n\t\t\tif(fit$limits[i,2]<Inf){\n\t\t\td.index <- c(1:6)\n\t\t\t}\n\t\t}\n\t\t\n\t\tif(dist == \"best\"){\n\t\t\td.select <- which(fit$ssq[i,] == min(fit$ssq[i, d.index]))[1]\n\t\t}else{\n\t\t\td.select <- which(dist == c(\"normal\", \"t\", \"gamma\", \"lognormal\", \"logt\",\"beta\"))\n\t\t}\n\t\t\n\t\tdistributions[1,i] <- distribution.names[d.select]\n\t\t\n\t\ttemp <- feedbacksingle(fit, quantiles, values, ex = i)\n\t\texpert.quantiles[, i] <- temp$fitted.quantiles[, d.select]\n\t\texpert.probs[, i] <- temp$fitted.probabilities[, d.select]\n\t}\n\t\n\t\n\tlist(expert.quantiles = signif(expert.quantiles, sfg), expert.probs = signif(expert.probs, sfg), distributions = distributions)\n}\n",
    "created" : 1467873487030.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1366925879",
    "id" : "52C25974",
    "lastKnownWriteTime" : 1467873515,
    "last_content_update" : 1467873515439,
    "path" : "~/Dropbox/Research/R packages/SHELF/SHELF1.2.0.9001/R/feedbackgroup.R",
    "project_path" : "R/feedbackgroup.R",
    "properties" : {
    },
    "relative_order" : 9,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}